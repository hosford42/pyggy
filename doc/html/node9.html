<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<link rel="STYLESHEET" href="pyggy.css" type='text/css'>
<link rel="SHORTCUT ICON" href="icons/pyfav.gif">
<link rel="first" href="pyggy.html" title='PyGgy Manual'>
<link rel='contents' href='contents.html' title="Contents">
<link rel='last' href='about.html' title='About this document...'>
<link rel='help' href='about.html' title='About this document...'>
<LINK REL="next" HREF="node10.html">
<LINK REL="prev" HREF="node8.html">
<LINK REL="parent" HREF="node4.html">
<LINK REL="next" HREF="node10.html">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name='aesop' content='information'>
<META NAME="description" CONTENT="Using PyLly with PLY">
<META NAME="keywords" CONTENT="pyggy">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<title>2.5 Using PyLly with PLY</title>
</head>
<body>
<DIV CLASS="navigation">
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td><a rel="prev" title="2.4 Visualization" 
  HREF="node8.html"><img src='icons/previous.gif'
border='0' height='32'  alt='Previous Page' width='32'></A></td>
<td><a rel="parent" title="2. Quick Start" 
  HREF="node4.html"><img src='icons/up.gif'
border='0' height='32'  alt='Up One Level' width='32'></A></td>
<td><a rel="next" title="2.6 More Examples" 
  HREF="node10.html"><img src='icons/next.gif'
border='0' height='32'  alt='Next Page' width='32'></A></td>
<td align="center" width="100%">PyGgy Manual</td>
<td><a rel="contents" title="Table of Contents" 
  href="contents.html"><img src='icons/contents.gif'
border='0' height='32'  alt='Contents' width='32'></A></td>
<td><img src='icons/blank.gif'
  border='0' height='32'  alt='' width='32'></td>
</tr></table>
<b class="navlabel">Previous:</b>
<a class="sectref" rel="prev" HREF="node8.html">2.4 Visualization</A>
<b class="navlabel">Up:</b>
<a class="sectref" rel="parent" HREF="node4.html">2. Quick Start</A>
<b class="navlabel">Next:</b>
<a class="sectref" rel="next" HREF="node10.html">2.6 More Examples</A>
<br><hr>
</DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION004500000000000000000">
2.5 Using PyLly with PLY</A>
</H1>
Lexers generated by PyLly can be used by PyGgy parsers or by
other parser packages.  The lexer interface was designed to be
similar enough to PLY's lexer interface that PyLly lexers can
be used as-is.  For other parsers, a small wrapper may class
may be needed around the lexer to provide the proper interface.

<P>
The <span class="file">example/ply_calc.py</span> example illustrates how to use
a PLY parser with a PyLly lexer.  This is a small calculator test 
case based on the example from the PLY web site 
(<em class="citetitle"><a
 href="http://systems.cs.uchicago.edu/ply/example.html"
 title="http://systems.cs.uchicago.edu/ply/example.html"
 >http://systems.cs.uchicago.edu/ply/example.html</a></em>).
The <span class="file">example/ply_calc.pyl</span> file specifies the lexer:

<P>
<div class="verbatim"><pre>
code :
    tokens = (
        'NAME','NUMBER',
        'PLUS','MINUS','TIMES','DIVIDE','EQUALS',
        'LPAREN','RPAREN',
    )

    lineno = 1

    class Tok :
        def __init__(self, l, type) :
            self.type = type
            self.lineno = lineno
            self.value = l.value
        def __str__(self) :
            return "Tok(%s,%r,%d)" % (self.type, self.value, self.lineno)

definitions :
    NAME    "[[:alpha:]_][[:alnum:]_]*"
    NUMBER  "[[:digit:]]+"

INITIAL :
    "\+" :  return Tok(self, "PLUS")
    "-" :   return Tok(self, "MINUS")
    "\*" :  return Tok(self, "TIMES")
    "/" :   return Tok(self, "DIVIDE")
    "=" :   return Tok(self, "EQUALS")
    "\(" :  return Tok(self, "LPAREN")
    "\)" :  return Tok(self, "RPAREN")

    "{NAME}":   return Tok(self, "NAME")
    "{NUMBER}":
        try :
            self.value = int(self.value)
        except ValueError :
            print "Integer value too large", self.value
            self.value = 0
        return Tok(self, "NUMBER")

    "[[:blank:]]" : return
    "\n+" :
        global lineno
        lineno += len(self.value)
        return

    "." :
        print "Illegal character '%s'" % self.value
        return
</pre></div>

<P>
Each token's value is represented by a <code>Tok</code> instance
which adheres to PLY's token interface.  The specification
also defines a list of tokens in the <code>tokens</code> variable
as needed by PLY.  The <span class="file">examples/ply_calc.py</span> script
builds the lexer and uses it to feed a PLY parser:

<P>
<div class="verbatim"><pre>
# build the lexer
import pyggy
l,lexer = pyggy.getlexer("ply_calc.pyl")
tokens = lexer.tokens

[...]

import yacc
yacc.yacc()

while 1:
    sys.stdout.write("calc &gt; ")
    line = sys.stdin.readline()
    if line == "" :
        break

    l.setinputstr(line)
    yacc.parse(lexer=l)
</pre></div>

<P>

<DIV CLASS="navigation">
<p><hr>
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td><a rel="prev" title="2.4 Visualization" 
  rel="prev" title="2.4 Visualization" 
  HREF="node8.html"><img src='icons/previous.gif'
border='0' height='32'  alt='Previous Page' width='32'></A></td>
<td><a rel="parent" title="2. Quick Start" 
  rel="parent" title="2. Quick Start" 
  HREF="node4.html"><img src='icons/up.gif'
border='0' height='32'  alt='Up One Level' width='32'></A></td>
<td><a rel="next" title="2.6 More Examples" 
  rel="next" title="2.6 More Examples" 
  HREF="node10.html"><img src='icons/next.gif'
border='0' height='32'  alt='Next Page' width='32'></A></td>
<td align="center" width="100%">PyGgy Manual</td>
<td><a rel="contents" title="Table of Contents" 
  rel="contents" title="Table of Contents" 
  href="contents.html"><img src='icons/contents.gif'
border='0' height='32'  alt='Contents' width='32'></A></td>
<td><img src='icons/blank.gif'
  border='0' height='32'  alt='' width='32'></td>
</tr></table>
<b class="navlabel">Previous:</b>
<a class="sectref" rel="prev" HREF="node8.html">2.4 Visualization</A>
<b class="navlabel">Up:</b>
<a class="sectref" rel="parent" HREF="node4.html">2. Quick Start</A>
<b class="navlabel">Next:</b>
<a class="sectref" rel="next" HREF="node10.html">2.6 More Examples</A>
<hr>
<span class="release-info">Release 0.4, documentation updated on October 15, 2004.</span>
</DIV>
<!--End of Navigation Panel-->
<ADDRESS>
See the <a href="http://www.lava.net/~newsham/pyggy/">PyGgy Home Page</a>.
</ADDRESS>
</BODY>
</HTML>
